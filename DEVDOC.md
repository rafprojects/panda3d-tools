# Code Details

### **General Stuff**
This is a place tracking/reasoning the development choices and methodology used in this project.

The Panda3d ShowBase is loaded in a class separate from the main Game class that runs the game.
The ShowBase "base" object is shared by other class objects by passing it through them as a parameter.
I'm not sure if this has any particular benefit yet, but was a good personal exercise of class inheritance

The "sprites" for player (and eventually all other active sprite characters and such) are actually sequenced textures on panda3d models (constructed by the Eggmodel class), which gives it a cleaner look than the texture swapping technique previously used.  
This is apparently better compatable with panda3d, since it's technically a "3d" model,
and the sprite animation is doing the same thing automatically "on top" of the model.

### **BULLETS**

The bullet class is a child of the Panda3d NodePath. The "sprite" is a bullet egg model that is reparented to the class object itself, so that the entire NodePath/sprite can be parented to render as one.  This is the only way to get the bullet to visually move across the screen.

> NOTE: We might be able to make this much more flexible by setting the bullet model as a parameter rather than hardcode, and the scale/vel in a reference table for weapons.

The class has flexible scale and velocity, the latter of which is a Player class variable that is read by the spacekey listener as the parameter for the Player fire_bullet function.
This flexibility is intended for future powerup implementations.

The Bullet class' update_pos method is called within the Player update_bullets method in order to update each bullet object's position.  The update_bullets method is set in the taskMgr.

### **COLLISION**

This has been challenging to implement, particularly because of the way I divided the parts of the code (i.e. separate base, eggmodel & entity to inherit, etc)
Originally I had implemented the collision setup separately on each class, but later moved that to the Entity class, so it can apply to any created entity.

I had an issue with the collision boxes for Enemy & Player appearing in the screen center, rather than attached to them.  Later I realized that the created collisionNode wasn't being attached to the right thing (the Entity object's "self"), and had to be attached to the *model* (i.e. self.model.attachNewNode(self.collNode))

Sizing was basically automated by a small function which reads the target eggfile for the dimensions and produces the 2 tuples of coordinates required by the 2 Point3 objects for the CollisionBox.

Now the last part is adjusting the position of the box to overlay the sprite image properly...

**Update**

So the issue was in the vertice layout within the egg files generated by egg-texture-cards.
The default sets the model essentially offset within the 3D space, with its corner starting at 0,0,0.
We need the model to be centered within the 3D plane in order to align with everything properly.
In order to do this, the easiest way is a manual edit of the eggfile.
Divide the image dimensions in half and apply these values as the X and Y coordinates per vertex, according to the appropriate sign, as follows:
- 0: -, +
- 1: -, -
- 2: +, -
- 3: +, +